<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Last War 戰略指揮中心</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #0f172a;
            --card-bg: #1e293b;
            --primary: #3b82f6;   /* 科技藍 */
            --accent: #8b5cf6;    /* 紫色 */
            --gold: #f59e0b;      /* 金色 */
            --success: #10b981;
            --danger: #ef4444;
            --text-main: #f8fafc;
            --text-sub: #94a3b8;
        }

        body {
            font-family: 'Roboto', "Microsoft JhengHei", sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-main);
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            /* 背景裝飾 */
            background-image: radial-gradient(circle at 50% 0%, #2e1065 0%, var(--bg-dark) 60%);
        }

        .container {
            background-color: rgba(30, 41, 59, 0.9);
            width: 90%;
            max-width: 500px; /* 電腦版最大寬度 */
            padding: 2rem;
            border-radius: 24px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3), 0 0 0 1px rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            margin: 20px auto;
            box-sizing: border-box; /* 確保 padding 不會撐大寬度 */
        }

        /* 標題區域 */
        header {
            text-align: center;
            margin-bottom: 2rem;
        }

        h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.8rem;
            margin: 0;
            background: linear-gradient(135deg, #60a5fa, #c084fc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: 1px;
        }

        h2 {
            font-size: 0.9rem;
            color: var(--text-sub);
            margin-top: 0.5rem;
            font-weight: 400;
        }

        /* 日期選擇器 */
        .control-group {
            background: rgba(15, 23, 42, 0.6);
            padding: 1rem;
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .label-text {
            font-size: 0.9rem;
            color: var(--text-sub);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        input[type="date"] {
            width: 100%;
            padding: 12px;
            background: var(--bg-dark);
            border: 2px solid #334155;
            border-radius: 12px;
            color: white;
            font-size: 1.1rem;
            font-family: 'Roboto', sans-serif;
            box-sizing: border-box; /* 防止超出容器 */
            outline: none;
            transition: border-color 0.3s;
        }

        input[type="date"]:focus {
            border-color: var(--primary);
        }

        /* 結果顯示區 */
        .result-card {
            background: linear-gradient(180deg, #2d3748 0%, #1a202c 100%);
            border-radius: 20px;
            padding: 1.5rem;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.2);
            min-height: 200px; /* 防止載入時跳動 */
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .group-name {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            text-shadow: 0 4px 12px rgba(0,0,0,0.5);
        }

        .server-grid {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px;
            margin-bottom: 1.5rem;
        }

        .badge {
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 12px;
            border-radius: 8px;
            font-weight: 700;
            font-size: 1rem;
            letter-spacing: 0.5px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .badge.highlight {
             background: var(--primary);
             box-shadow: 0 0 10px rgba(59, 130, 246, 0.5);
        }

        /* 複製按鈕 */
        .btn-copy {
            background: transparent;
            border: 1px solid rgba(255,255,255,0.2);
            color: var(--text-sub);
            padding: 8px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-copy:hover {
            background: rgba(255,255,255,0.1);
            color: white;
            border-color: white;
        }
        
        .btn-copy:active {
            transform: scale(0.95);
        }

        /* 搜尋區 */
        .search-area {
            margin-top: 2rem;
            border-top: 1px solid #334155;
            padding-top: 1.5rem;
        }

        .input-row {
            display: flex;
            gap: 10px;
        }

        input[type="number"] {
            flex: 1;
            padding: 12px;
            border-radius: 12px;
            border: 2px solid #334155;
            background: var(--bg-dark);
            color: white;
            font-size: 1rem;
            text-align: center;
            outline: none;
        }
        
        input[type="number"]:focus {
            border-color: var(--accent);
        }

        .btn-search {
            background: var(--accent);
            color: white;
            border: none;
            padding: 0 20px;
            border-radius: 12px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.1s;
        }

        .btn-search:active {
            transform: scale(0.95);
        }

        #searchResult {
            margin-top: 1rem;
            font-size: 0.95rem;
            min-height: 1.5rem;
            font-weight: 500;
        }

        /* ========== 手機版 RWD 調整 ========== */
        @media (max-width: 480px) {
            .container {
                width: 95%; /* 手機上更寬一點 */
                padding: 1.5rem;
                margin: 10px auto;
            }

            h1 {
                font-size: 1.5rem; /* 標題縮小 */
            }

            .group-name {
                font-size: 1.5rem; /* 組別名稱縮小 */
            }
            
            .badge {
                font-size: 0.9rem; /* 數字稍微縮小以容納更多 */
                padding: 6px 10px;
            }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>閃亮隱祕任務速查工具</h1>
        <h2>專屬於KT 的每位小夥伴</h2>
    </header>

    <div class="control-group">
        <div class="label-text"><i class="far fa-calendar-alt"></i> 選擇日期 (以重置日期為基準 10:00 AM)</div>
        <input type="date" id="dateInput">
    </div>

    <div class="result-card">
        <div id="groupName" class="group-name">計算中...</div>
        <div id="serverList" class="server-grid"></div>
        <button id="copyBtn" class="btn-copy" onclick="copyList()">
            <i class="far fa-copy"></i> 複製清單
        </button>
    </div>

    <div class="search-area">
        <div class="label-text" style="margin-bottom:10px;"><i class="fas fa-search"></i> 查詢特定伺服器</div>
        <div class="input-row">
            <input type="number" id="serverSearch" placeholder="輸入號碼 (如 1381)">
            <button class="btn-search" onclick="checkServer()">查詢</button>
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script>
    // 1. 資料庫
    const groups = {
        1: [1381, 1388, 1389, 1390, 1397, 1398, 1399, 1405, 1406, 1407, 1408],
        2: [1382, 1383, 1384, 1391, 1392, 1393, 1394, 1400, 1401, 1402, 1409, 1410, 1411, 1415, 1416, 1417, 1418],
        3: [1385, 1386, 1387, 1395, 1396, 1403, 1404, 1412, 1413, 1414, 1419, 1420]
    };

    // 2. 邏輯校正區
    // 目標：12/13 必須是第二組
    // 推算：如果 12/13 是 Group 2，那麼 12/12 必須是 Group 1。
    // 設定基準日為 12/12 (Group 1)
    const baseDate = new Date('2025-12-12T00:00:00');

    function getGroupForDate(inputDate) {
        const targetDate = new Date(inputDate);
        targetDate.setHours(0, 0, 0, 0); 
        
        const diffTime = targetDate - baseDate;
        const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
        
        // 數學邏輯：
        // 12/12 (diff 0) -> 餘數 0 -> 對應 Group 1
        // 12/13 (diff 1) -> 餘數 1 -> 對應 Group 2
        // 12/14 (diff 2) -> 餘數 2 -> 對應 Group 3
        
        let cycleIndex = (diffDays % 3 + 3) % 3; // +3防止負數

        if (cycleIndex === 0) return 1;
        if (cycleIndex === 1) return 2;
        if (cycleIndex === 2) return 3;
    }

    function updateDisplay() {
        const dateInput = document.getElementById('dateInput').value;
        if (!dateInput) return;

        const groupNum = getGroupForDate(new Date(dateInput));
        
        const groupTitles = {
            1: "第一組 (Group 1)",
            2: "第二組 (Group 2)",
            3: "第三組 (Group 3)"
        };
        
        const titleEl = document.getElementById('groupName');
        titleEl.innerText = groupTitles[groupNum];
        
        // 顏色切換
        titleEl.style.color = "white";
        if(groupNum === 1) titleEl.style.color = "#f59e0b"; // 金
        if(groupNum === 2) titleEl.style.color = "#10b981"; // 綠
        if(groupNum === 3) titleEl.style.color = "#3b82f6"; // 藍

        const listContainer = document.getElementById('serverList');
        listContainer.innerHTML = '';
        groups[groupNum].sort((a,b) => a-b).forEach(server => {
            const badge = document.createElement('div');
            badge.className = 'badge';
            // 讓伺服器號碼如果是搜尋目標則高亮 (選擇性功能，這邊先統一)
            if(groupNum === 1) badge.style.borderColor = "#f59e0b";
            if(groupNum === 2) badge.style.borderColor = "#10b981";
            if(groupNum === 3) badge.style.borderColor = "#3b82f6";
            
            badge.innerText = server;
            listContainer.appendChild(badge);
        });
    }

    function checkServer() {
        const serverInput = document.getElementById('serverSearch');
        const serverNum = parseInt(serverInput.value);
        const resultDiv = document.getElementById('searchResult');
        
        if (!serverNum) {
            resultDiv.innerText = "請輸入號碼";
            resultDiv.style.color = "var(--danger)";
            return;
        }

        let foundGroup = null;
        for (let g in groups) {
            if (groups[g].includes(serverNum)) {
                foundGroup = g;
                break;
            }
        }

        if (foundGroup) {
            resultDiv.innerHTML = `<span style="color:var(--success)"><i class="fas fa-check"></i> 伺服器 ${serverNum} 是第 ${foundGroup} 組</span>`;
        } else {
            resultDiv.innerHTML = `<span style="color:var(--danger)"><i class="fas fa-times"></i> 找不到伺服器 ${serverNum}</span>`;
        }
    }
    
    // 複製清單功能
    function copyList() {
        const list = document.getElementById('serverList');
        if (!list || list.children.length === 0) return;

        // 整理文字
        const servers = Array.from(list.children).map(badge => badge.innerText).join(', ');
        const groupName = document.getElementById('groupName').innerText;
        const dateStr = document.getElementById('dateInput').value;
        
        const textToCopy = `[閃亮任務小工具]\n\n今日的閃亮任務: ${servers}`;

        // 建立臨時 textarea 進行複製 (相容性較佳)
        const textArea = document.createElement("textarea");
        textArea.value = textToCopy;
        document.body.appendChild(textArea);
        textArea.select();
        
        try {
            document.execCommand('copy');
            // 按鈕回饋
            const btn = document.getElementById('copyBtn');
            const originalText = '<i class="far fa-copy"></i> 複製清單';
            btn.innerHTML = '<i class="fas fa-check"></i> 已複製';
            btn.style.borderColor = "var(--success)";
            btn.style.color = "var(--success)";
            
            setTimeout(() => {
                btn.innerHTML = originalText;
                btn.style.borderColor = "rgba(255,255,255,0.2)";
                btn.style.color = "var(--text-sub)";
            }, 2000);
        } catch (err) {
            alert('複製失敗，請手動選取文字複製');
        }
        
        document.body.removeChild(textArea);
    }
    
    // 綁定 Enter 鍵
    document.getElementById('serverSearch').addEventListener('keypress', function(e) {
        if(e.key === 'Enter') checkServer();
    });

    function initDate() {
        const now = new Date();
        
        // 台灣時間轉換 (UTC+8)
        const utc = now.getTime() + (now.getTimezoneOffset() * 60000);
        const taiwanTime = new Date(utc + (3600000 * 8));

        const currentHour = taiwanTime.getHours();

        // 10點前算前一天
        if (currentHour < 10) {
            taiwanTime.setDate(taiwanTime.getDate() - 1);
        }

        const yyyy = taiwanTime.getFullYear();
        const mm = String(taiwanTime.getMonth() + 1).padStart(2, '0');
        const dd = String(taiwanTime.getDate()).padStart(2, '0');
        
        document.getElementById('dateInput').value = `${yyyy}-${mm}-${dd}`;
        updateDisplay();
    }

    document.getElementById('dateInput').addEventListener('change', updateDisplay);
    initDate();

</script>

</body>
</html>
